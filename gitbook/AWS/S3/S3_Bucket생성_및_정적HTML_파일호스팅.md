# S3 Bucket 생성 및 정적 HTML 파일 호스팅

# S3 의 개념

![이미지](./img/1.png)

S3 의 개념을 정리하기 위해 그림을 Power Point 에서 그려본 그림이다. (이거 하나 그리는 데에만 30분 이상 걸렸다. 쓸만한 아이콘 구하는 작업이 꽤 걸렸던것 같다)  

위 그림에서 보이듯이 S3의 위치는 Cloud Front 와 Bucket(버킷)의 중간위치에 존재한다. S3 내에는 Bucket(버킷)이라고 불리우는 존재를 이름을 붙여서 여러개를 가지고 있을 수 있다.  

Cloud Front 는 CDN(Contents Delivery Network) 서비스이다. Cloud Front에 대한 자세한 설명은 [여기](https://aws.amazon.com/ko/cloudfront/) 를 참고하자. Cloud Front 는 단순히 S3 만이 아니라 다양한 AWS의 서비스들에 결합할 수 있다. 이렇게 다양한 AWS의 서비스들과 Cloud Front 를 결합할 수 있지만, 그 중에서 S3를 Cloud Front에 결합하는 과정을 다음 문서에서 예제를 통해서 정리할 예정이다.  ‌

S3 버킷을 생성해서 할 수 있는일들은 굉장히 다양하다. 오늘은 S3로 할수 있는 작업으로 정적 HTML 파일을 생성해서 호스팅하는 예제를 정리해봤다.  



# S3 버킷 인스턴스 생성 

aws.amazon.com 에 접속해서 login 후에 Management Console 에 진입하자.  

그리고 S3 서비스 페이지로 이동하기 위해 검색 창에 s3 를 입력.  

![이미지](./img/2.png)



**버킷 만들기** 클릭

![이미지](./img/3.png)

버킷의 이름을 지어주어야 한다. 이 버킷의 이름은 게임의 ID와 유사한 역할을 해서 Amazon 서비스 내에서 유일한 이름이 되어야 한다. ( 참고 : [버킷 이름 지정 규칙 및 제한](https://docs.aws.amazon.com/AmazonS3/latest/dev/BucketRestrictions.html#bucketnamingrules) ). 내 경우는 생성한 버킷에 html을 올려서 html 파일이 로드 되는지 확인만 해보고 버킷을 지울 예정이다. 이런 이유로 이름을 대충 html-test-1a2b3c 라고 지었다. 게임 아이디 짓듯이... 너무나 어려운과정이다.  

![이미지](./img/4.png)

보안에 대한 내용인데, 보안에 대한 내용은 모두 해제해주었다. 단순 정적 html 파일만을 공개할 예정이기 때문이다. 그리고 `버킷에 대한 모든 객체가 퍼블릭 상태가 될 수 있음을 알고 있습니다.`  라고 적혀있는 체크박스에 체크를 해서 동의를 해주었다.  

![이미지](./img/5.png)

이제 나머지로는 아래의 항목들이 있는데,  여기에 대한 부분들은 모두 기본값으로 내버려 두었다.  ‌

- 버킷 버전 관리
- 태그 - 선택 사항
- 기본 암호화
- 고급 설정 

그리고 **버킷 만들기** 버튼을 클릭하자.

![이미지](./img/6.png)

버킷이 생성된 모습  

![이미지](./img/7.png)

# 정적 웹 사이트 호스팅 ‌

## 버킷에 대한 '정적 웹 사이트 호스팅' 활성화  

방금 생성했던 버킷인 html-test-1a2b3c 를 클릭해서 버킷 설정 페이지로 이동하자.

![이미지](./img/8.png)

속성 탭 클릭

![이미지](./img/9.png)

편집 버튼 클릭

![이미지](./img/10.png)



- 정적 웹사이트 호스팅 > 활성화 버튼 클릭
- 호스팅 유형 > 정적 웹 사이트 호스팅 클릭
- 인덱스 문서 : index.html 입력
  - 다른 파일 명을 사용하고 싶다면 임의로 이름을 바꿔서 지정하는 것이 가능하다.
- 오류 문서 : 
  - 다른 파일 명을 사용하고 싶다면 임의로 이름을 바꿔서 지정하는 것이 가능하다.

![이미지](./img/11.png)

  

변경 사항 저장 버튼 클릭  

![이미지](./img/12.png)



## 권한(Permission) 편집 ‌

권한 탭 클릭 > 버킷 정책 > 편집 버튼 클릭 

![이미지](./img/13.png)



ARN 이라고 불리는 ID 를 복사해두어야 정책 생성기에 입력할 수 있으므로 아래 그림처럼 복사 버튼을 눌러서 ARN 값을 복사해주자.

![이미지](./img/14.png)

‌

[정책 생성기](https://awspolicygen.s3.amazonaws.com/policygen.html) (AWS Policy Generator) 버튼 클릭  

![이미지](./img/15.png)



- Step 1: Select Policy Type
  - S3 Bucket Policy 선택
- Step 2 : Add Statement(s)
  - Principal : `*` 을 입력해주자.
  - Actions : `All Actions ('*')`  선택
  - Amazon Resource Name (ARN) : 방금전 복사해둔 ARN 이름을 붙여넣기

Add Statement 버튼 클릭 

![이미지](./img/16.png)



**Generate Policy** 클릭

![이미지](./img/17.png)

입력한 항목에 대해서 JSON 형식으로 정책이 생성되는데 이것을 복사해두자.

![이미지](./img/18.png)

이제 버킷 정책 편집 페이지로 돌아와서 정책 에디터에 해당 내용을 복사해서 붙여넣어주자.  ‌

그리고 Resource 에 해당하는 값에 ARN 아이디 뒤에 `/*` 을 덧붙여주자. `/*` 을 붙이게 되면 현재 버킷의 아래의 모든 파일들에 대해서 

- Effect 는 `Allow` 이고
- Action 은 `s3: *` 이면서
- Principal 은 `*` 인 정책 

을 의미하는 정책이 만들어지게 된다. 조금 더 쉽게 풀어서 써보면 아래의 정책은 "**이 버킷 아래의 모든 것에 대해서 외부로 나가는 것을 허용합니다."** 라는 의미가 된다. 그리고 이제 저장 버튼을 눌러주자.  

![이미지](./img/19.png)



# 정적 HTML 파일 업로드 

객체 탭 클릭 > 업로드 버튼 클릭 

![이미지](./img/20.png)



파일 추가 버튼 클릭  

![이미지](./img/21.png)



파일 업로드  

![이미지](./img/22.png)



업로드가 끝나면 업로드가 된 개별 파일에 대해 아래와 같이 링크가 생성된다.  

![이미지](./img/23.png)



위 그림에 나타난 파일 들 중에서 index.html 파일을 클릭해서 세부 페이지로 이동하면 아래와 같은 페이지가 나타난다. 그리고 URL 을 복사해서 해당 index.html 페이지에 접속해보자.  

![이미지](./img/24.png)



접속해보면 아래와 같은 페이지가 나타난다.

![이미지](./img/25.png)



끝...